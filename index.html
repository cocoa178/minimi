<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>minimi</title>
    <meta name="theme-color" content="#FAFAFA">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --bg-primary: #FAFDFF;
            --bg-secondary: #FFFFFF;
            --text-primary: #0F0F12;
            --text-secondary: #AA9D9C;
            --text-muted: #5D5D5D;
            --border-light: #E8E8E8;
            --accent-mint: #B1D9D4;
            --accent-pink: #FFD4DE;
            --accent-chocolate: #6B5344;
            --font-korean: 'Apple SD Gothic Neo', -apple-system, BlinkMacSystemFont, system-ui, sans-serif;
        }
        body { font-family: var(--font-korean); background: var(--bg-primary); color: var(--text-primary); letter-spacing: -0.02em; min-height: 100vh; }
        .app-container { max-width: 430px; margin: 0 auto; background: white; min-height: 100vh; box-shadow: 0 0 20px rgba(0,0,0,0.1); position: relative; }
        
        /* Header */
        .app-header-bar { display: flex; align-items: center; justify-content: space-between; padding: 1rem; background: white; border-bottom: 1px solid var(--border-light); position: sticky; top: 0; z-index: 100; }
        .header-left { display: flex; align-items: center; gap: 1rem; }
        .menu-icon { width: 18px; height: 24px; display: flex; flex-direction: column; justify-content: center; gap: 3px; cursor: pointer; }
        .menu-icon span { width: 100%; height: 2px; background: var(--text-primary); }
        .app-search-input { font-size: 0.9rem; background: #F3F4F6; border: none; border-radius: 8px; padding: 0.5rem 0.75rem; width: 140px; outline: none; font-family: var(--font-korean); }
        .header-right { display: flex; align-items: center; gap: 0.5rem; }
        .add-btn { width: 28px; height: 28px; display: flex; align-items: center; justify-content: center; cursor: pointer; font-size: 1.5rem; color: #888; }
        .profile-pic { width: 36px; height: 36px; border-radius: 50%; background: var(--accent-pink); display: flex; align-items: center; justify-content: center; font-size: 1rem; cursor: pointer; }
        
        /* Pages */
        .main-content { padding-bottom: 80px; min-height: calc(100vh - 60px); }
        .page { display: none; }
        .page.active { display: block; }
        
        /* Memo Cards - Masonry */
        .cards-compact { column-count: 2; column-gap: 0.5rem; padding: 1rem; }
        .card-mini { break-inside: avoid; margin-bottom: 0.5rem; background: white; border: 1px solid var(--border-light); border-radius: 8px; overflow: hidden; cursor: pointer; transition: transform 0.2s; }
        .card-mini:hover { transform: translateY(-2px); }
        .card-image-placeholder { width: 100%; }
        .card-image-placeholder img { width: 100%; display: block; }
        .card-content-wrapper { padding: 0.6rem; }
        .card-title { font-size: 0.8rem; font-weight: 600; margin-bottom: 0.25rem; }
        .card-date { font-size: 0.65rem; color: var(--text-secondary); margin-bottom: 0.25rem; }
        .card-content-text { font-size: 0.75rem; color: var(--text-muted); line-height: 1.5; display: -webkit-box; -webkit-line-clamp: 4; -webkit-box-orient: vertical; overflow: hidden; white-space: pre-wrap; }
        .card-tag { display: inline-block; font-size: 0.6rem; padding: 2px 6px; background: var(--accent-mint); border-radius: 4px; margin-top: 0.4rem; }
        .empty-state { text-align: center; padding: 60px 20px; color: var(--text-secondary); }
        .empty-icon { font-size: 3rem; margin-bottom: 1rem; }
        .empty-text { font-size: 0.9rem; }
        
        /* Archive */
        .archive-tabs { display: flex; gap: 0.5rem; padding: 1rem; overflow-x: auto; border-bottom: 1px solid var(--border-light); }
        .archive-tab { padding: 0.5rem 1rem; border-radius: 20px; font-size: 0.85rem; border: 1px solid var(--border-light); background: white; cursor: pointer; white-space: nowrap; color: var(--text-muted); transition: all 0.2s; }
        .archive-tab.active { background: var(--text-primary); color: white; border-color: var(--text-primary); }
        .archive-content { padding: 1rem; }
        .archive-calendar { background: white; border: 1px solid var(--border-light); border-radius: 12px; padding: 1rem; margin-bottom: 1rem; }
        .calendar-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; }
        .calendar-title { font-size: 1rem; font-weight: 600; }
        .calendar-nav button { background: none; border: none; font-size: 1rem; cursor: pointer; padding: 0.25rem 0.5rem; }
        .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 0.25rem; }
        .cal-weekday { font-size: 0.7rem; color: var(--text-secondary); text-align: center; padding: 0.25rem; }
        .cal-day { aspect-ratio: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; border-radius: 6px; cursor: pointer; font-size: 0.75rem; position: relative; }
        .cal-day:hover { background: var(--bg-primary); }
        .cal-day.today { background: var(--accent-mint); font-weight: 600; }
        .cal-day.has-content::after { content: ''; position: absolute; bottom: 4px; width: 4px; height: 4px; background: var(--accent-pink); border-radius: 50%; }
        .archive-list { display: flex; flex-direction: column; gap: 0.5rem; }
        .archive-item { display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem; background: white; border: 1px solid var(--border-light); border-radius: 8px; }
        .archive-item-thumb { width: 50px; height: 70px; background: var(--border-light); border-radius: 4px; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; flex-shrink: 0; }
        .archive-item-info { flex: 1; min-width: 0; }
        .archive-item-title { font-size: 0.9rem; font-weight: 500; margin-bottom: 0.25rem; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .archive-item-date { font-size: 0.75rem; color: var(--text-secondary); }
        .archive-item-delete { background: none; border: none; color: var(--text-secondary); cursor: pointer; font-size: 1.2rem; padding: 0.5rem; }
        
        /* Lab */
        .lab-tabs { display: flex; border-bottom: 1px solid var(--border-light); }
        .lab-tab { flex: 1; padding: 1rem; text-align: center; font-size: 0.85rem; color: var(--text-secondary); cursor: pointer; border-bottom: 2px solid transparent; transition: all 0.2s; }
        .lab-tab.active { color: var(--text-primary); border-bottom-color: var(--text-primary); font-weight: 600; }
        .lab-content { padding: 1rem; }
        .lab-tab-content { display: none; }
        .lab-tab-content.active { display: block; }
        .section-title { font-size: 0.85rem; color: var(--text-secondary); margin-bottom: 0.75rem; }
        .emotion-input-area { background: white; border: 1px solid var(--border-light); border-radius: 12px; padding: 1rem; margin-bottom: 1rem; }
        .emotion-question { font-size: 0.9rem; margin-bottom: 1rem; text-align: center; }
        .emotion-scale { display: flex; justify-content: space-between; gap: 0.5rem; }
        .emotion-btn { flex: 1; aspect-ratio: 1; border: none; border-radius: 12px; cursor: pointer; font-size: 1.5rem; transition: transform 0.2s; background: #F3F4F6; }
        .emotion-btn:hover { transform: scale(1.1); }
        .emotion-btn.selected { box-shadow: 0 0 0 3px var(--accent-mint); transform: scale(1.1); }
        .emotion-graph { background: white; border: 1px solid var(--border-light); border-radius: 12px; padding: 1rem; overflow-x: auto; margin-bottom: 1rem; }
        .emotion-graph-scroll { display: flex; gap: 0.5rem; min-width: max-content; }
        .emotion-bar-item { display: flex; flex-direction: column; align-items: center; gap: 0.25rem; width: 36px; }
        .emotion-bar { width: 24px; background: linear-gradient(to top, var(--accent-mint), var(--accent-pink)); border-radius: 4px 4px 0 0; min-height: 10px; }
        .emotion-bar-label { font-size: 0.6rem; color: var(--text-secondary); }
        .timer-display { text-align: center; padding: 2rem; background: white; border: 1px solid var(--border-light); border-radius: 16px; margin-bottom: 1rem; }
        .timer-time { font-size: 4rem; font-weight: 300; font-family: 'SF Mono', 'Menlo', monospace; margin-bottom: 0.5rem; }
        .timer-label { font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 1.5rem; }
        .timer-controls { display: flex; justify-content: center; gap: 1rem; }
        .timer-btn { padding: 0.75rem 2rem; border-radius: 24px; font-size: 0.9rem; cursor: pointer; border: none; }
        .timer-btn.primary { background: var(--accent-mint); }
        .timer-btn.secondary { background: var(--border-light); }
        .report-card { background: white; border: 1px solid var(--border-light); border-radius: 12px; padding: 1rem; margin-bottom: 1rem; }
        .report-card-title { font-size: 0.8rem; color: var(--text-secondary); margin-bottom: 0.5rem; }
        .report-stat { font-size: 1.5rem; font-weight: 600; }
        .report-stat-sub { font-size: 0.8rem; color: var(--text-muted); margin-top: 0.25rem; }
        .report-period-selector { display: flex; justify-content: center; gap: 0.5rem; margin-bottom: 1.5rem; }
        .period-btn { padding: 0.5rem 1.25rem; border-radius: 20px; border: 1px solid var(--border-light); background: white; cursor: pointer; font-size: 0.85rem; }
        .period-btn.active { background: var(--text-primary); color: white; border-color: var(--text-primary); }
        .report-keywords { display: flex; flex-wrap: wrap; gap: 0.5rem; }
        .keyword-tag { padding: 0.4rem 0.75rem; background: #E8F5F3; border-radius: 12px; font-size: 0.8rem; }
        .keyword-tag.highlight { background: var(--accent-mint); }
        .export-section { background: linear-gradient(135deg, var(--accent-mint) 0%, #D4E9E6 100%); border-radius: 16px; padding: 1.5rem; text-align: center; margin-top: 1rem; }
        .export-title { font-size: 1rem; font-weight: 600; margin-bottom: 0.5rem; }
        .export-desc { font-size: 0.8rem; color: var(--text-muted); margin-bottom: 1rem; line-height: 1.5; }
        .export-btn { background: var(--text-primary); color: white; border: none; padding: 0.75rem 2rem; border-radius: 24px; font-size: 0.9rem; cursor: pointer; }
        
        /* Bottom Nav */
        .bottom-nav { position: fixed; bottom: 0; left: 50%; transform: translateX(-50%); width: 100%; max-width: 430px; background: white; border-top: 1px solid var(--border-light); display: flex; z-index: 100; }
        .nav-item { flex: 1; display: flex; flex-direction: column; align-items: center; gap: 0.25rem; padding: 0.75rem; background: none; border: none; cursor: pointer; color: var(--text-secondary); font-size: 0.7rem; }
        .nav-item.active { color: var(--text-primary); }
        .nav-icon { font-size: 1.2rem; }
        
        /* Modal */
        .modal-overlay { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); display: none; align-items: flex-end; justify-content: center; z-index: 1000; }
        .modal-overlay.active { display: flex; }
        .modal { background: white; border-radius: 20px 20px 0 0; width: 100%; max-width: 430px; max-height: 90vh; overflow-y: auto; animation: slideUp 0.3s ease; }
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
        .modal-header { display: flex; justify-content: space-between; align-items: center; padding: 1.25rem; border-bottom: 1px solid var(--border-light); position: sticky; top: 0; background: white; }
        .modal-title { font-size: 1rem; font-weight: 600; }
        .modal-close { background: none; border: none; font-size: 1.5rem; cursor: pointer; color: var(--text-secondary); }
        .modal-body { padding: 1.25rem; }
        .form-group { margin-bottom: 1rem; }
        .form-label { display: block; font-size: 0.85rem; font-weight: 500; margin-bottom: 0.5rem; }
        .form-input, .form-textarea { width: 100%; padding: 0.75rem; border: 1px solid var(--border-light); border-radius: 8px; font-size: 0.95rem; font-family: var(--font-korean); outline: none; }
        .form-input:focus, .form-textarea:focus { border-color: var(--accent-mint); }
        .form-textarea { min-height: 120px; resize: none; }
        .tag-selector { display: flex; flex-wrap: wrap; gap: 0.5rem; }
        .tag-option { padding: 0.4rem 0.75rem; border-radius: 16px; font-size: 0.8rem; border: 1px solid var(--border-light); background: white; cursor: pointer; }
        .tag-option.active { background: var(--accent-mint); border-color: var(--accent-mint); }
        .image-upload-area { border: 2px dashed var(--border-light); border-radius: 12px; padding: 2rem; text-align: center; cursor: pointer; }
        .image-upload-area:hover { border-color: var(--accent-mint); }
        .image-upload-area.has-image { padding: 0; border: none; }
        .image-upload-area img { width: 100%; border-radius: 12px; }
        .upload-icon { font-size: 2rem; margin-bottom: 0.5rem; }
        .upload-text { font-size: 0.85rem; color: var(--text-secondary); }
        .form-submit { width: 100%; background: var(--accent-mint); border: none; padding: 1rem; border-radius: 12px; font-size: 1rem; font-weight: 600; cursor: pointer; margin-top: 0.5rem; }
        .archive-type-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 0.75rem; margin-bottom: 1rem; }
        .archive-type-btn { padding: 1rem; border: 1px solid var(--border-light); border-radius: 12px; background: white; cursor: pointer; text-align: center; }
        .archive-type-btn.active { border-color: var(--accent-mint); background: #E8F5F3; }
        .archive-type-icon { font-size: 1.5rem; margin-bottom: 0.25rem; }
        .archive-type-label { font-size: 0.75rem; }
        .export-textarea { width: 100%; min-height: 300px; padding: 1rem; border: 1px solid var(--border-light); border-radius: 12px; font-size: 0.8rem; font-family: var(--font-korean); resize: none; line-height: 1.6; margin-bottom: 1rem; }
        .copy-btn { width: 100%; background: var(--accent-mint); border: none; padding: 1rem; border-radius: 12px; font-size: 1rem; font-weight: 600; cursor: pointer; }
        .copy-success { text-align: center; color: var(--accent-chocolate); font-size: 0.85rem; margin-top: 0.75rem; display: none; }
        .detail-image { width: 100%; border-radius: 12px; margin-bottom: 1rem; }
        .detail-title { font-size: 1.1rem; font-weight: 600; margin-bottom: 0.5rem; }
        .detail-meta { display: flex; gap: 0.75rem; font-size: 0.8rem; color: var(--text-secondary); margin-bottom: 1rem; }
        .detail-content { font-size: 0.95rem; line-height: 1.7; white-space: pre-wrap; }
        .detail-actions { display: flex; gap: 0.75rem; margin-top: 1.5rem; padding-top: 1rem; border-top: 1px solid var(--border-light); }
        .detail-btn { flex: 1; padding: 0.75rem; border-radius: 8px; border: none; font-size: 0.9rem; cursor: pointer; }
        .detail-btn.delete { background: #FFCDD2; color: #C62828; }
        
        /* Menu */
        .menu-overlay { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.3); z-index: 200; display: none; }
        .menu-overlay.active { display: block; }
        .menu-sidebar { position: fixed; top: 0; left: 0; width: 70%; max-width: 280px; height: 100%; background: white; padding: 1.5rem; transform: translateX(-100%); transition: transform 0.3s ease; z-index: 201; }
        .menu-overlay.active .menu-sidebar { transform: translateX(0); }
        .menu-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; }
        .menu-logo { font-size: 1.2rem; font-weight: 600; }
        .menu-close { background: none; border: none; font-size: 1.5rem; cursor: pointer; }
        .menu-item { padding: 0.75rem 0; font-size: 0.95rem; color: #666; cursor: pointer; display: flex; align-items: center; gap: 0.75rem; border-bottom: 1px solid var(--border-light); }
        .menu-item:hover { color: var(--text-primary); }
        
        /* Settings */
        .settings-item { display: flex; justify-content: space-between; align-items: center; padding: 1rem; border-bottom: 1px solid var(--border-light); }
        .settings-label { font-size: 0.9rem; }
        .settings-desc { font-size: 0.75rem; color: var(--text-secondary); margin-top: 0.25rem; }
        .settings-btn { padding: 0.5rem 1rem; border-radius: 8px; border: none; font-size: 0.85rem; cursor: pointer; }
        .settings-btn.primary { background: var(--accent-mint); }
        .settings-btn.danger { background: #FFCDD2; color: #C62828; }
    </style>
</head>
<body>
    <div class="app-container">
        <header class="app-header-bar">
            <div class="header-left">
                <div class="menu-icon" onclick="toggleMenu()"><span></span><span></span><span></span></div>
                <input type="text" class="app-search-input" placeholder="ê²€ìƒ‰" id="searchInput" oninput="handleSearch()">
            </div>
            <div class="header-right">
                <div class="add-btn" onclick="openAddModal()">+</div>
                <div class="profile-pic" onclick="showPage('settings')">ğŸ˜Š</div>
            </div>
        </header>

        <main class="main-content page active" id="page-memo">
            <div class="cards-compact" id="memoContainer"></div>
        </main>

        <main class="main-content page" id="page-archive">
            <div class="archive-tabs">
                <button class="archive-tab active" data-type="book" onclick="selectArchiveType('book')">ğŸ“š ì±…</button>
                <button class="archive-tab" data-type="movie" onclick="selectArchiveType('movie')">ğŸ¬ ì˜í™”</button>
                <button class="archive-tab" data-type="tv" onclick="selectArchiveType('tv')">ğŸ“º TV</button>
                <button class="archive-tab" data-type="music" onclick="selectArchiveType('music')">ğŸµ ìŒì•…</button>
                <button class="archive-tab" data-type="place" onclick="selectArchiveType('place')">ğŸ“ ì¥ì†Œ</button>
            </div>
            <div class="archive-content">
                <div class="archive-calendar">
                    <div class="calendar-header">
                        <button onclick="prevMonth()">â—€</button>
                        <span class="calendar-title" id="calendarTitle">2026ë…„ 1ì›”</span>
                        <button onclick="nextMonth()">â–¶</button>
                    </div>
                    <div class="calendar-grid" id="calendarGrid"></div>
                </div>
                <div class="archive-list" id="archiveList"></div>
            </div>
        </main>

        <main class="main-content page" id="page-lab">
            <div class="lab-tabs">
                <div class="lab-tab active" data-tab="emotion" onclick="selectLabTab('emotion')">ê°ì • ê·¸ë˜í”„</div>
                <div class="lab-tab" data-tab="timer" onclick="selectLabTab('timer')">ì§‘ì¤‘ íƒ€ì´ë¨¸</div>
                <div class="lab-tab" data-tab="report" onclick="selectLabTab('report')">ë¦¬í¬í„°M</div>
            </div>
            <div class="lab-content">
                <div class="lab-tab-content active" id="tab-emotion">
                    <div class="section-title">ì§€ê¸ˆ ê¸°ë¶„ ê¸°ë¡í•˜ê¸°</div>
                    <div class="emotion-input-area">
                        <p class="emotion-question">ì˜¤ëŠ˜ ê¸°ë¶„ì´ ì–´ë•Œìš”?</p>
                        <div class="emotion-scale">
                            <button class="emotion-btn" data-level="1" onclick="setEmotion(1)">ğŸ˜Š</button>
                            <button class="emotion-btn" data-level="2" onclick="setEmotion(2)">ğŸ™‚</button>
                            <button class="emotion-btn" data-level="3" onclick="setEmotion(3)">ğŸ˜</button>
                            <button class="emotion-btn" data-level="4" onclick="setEmotion(4)">ğŸ˜”</button>
                            <button class="emotion-btn" data-level="5" onclick="setEmotion(5)">ğŸ˜¢</button>
                        </div>
                    </div>
                    <div class="section-title">ìµœê·¼ 2ì£¼ ê°ì • íë¦„</div>
                    <div class="emotion-graph"><div class="emotion-graph-scroll" id="emotionGraph"></div></div>
                </div>
                <div class="lab-tab-content" id="tab-timer">
                    <div class="timer-display">
                        <div class="timer-time" id="timerDisplay">25:00</div>
                        <div class="timer-label" id="timerLabel">ì§‘ì¤‘ ì‹œê°„</div>
                        <div class="timer-controls">
                            <button class="timer-btn primary" id="timerStartBtn" onclick="toggleTimer()">ì‹œì‘</button>
                            <button class="timer-btn secondary" onclick="resetTimer()">ë¦¬ì…‹</button>
                        </div>
                    </div>
                    <div class="report-card">
                        <div class="report-card-title">ì˜¤ëŠ˜ì˜ ì§‘ì¤‘</div>
                        <div class="report-stat" id="todayFocusTime">0ë¶„</div>
                        <div class="report-stat-sub" id="todayFocusCount">0íšŒ ì™„ë£Œ</div>
                    </div>
                </div>
                <div class="lab-tab-content" id="tab-report">
                    <div class="report-period-selector">
                        <button class="period-btn active" data-period="daily" onclick="selectPeriod('daily')">ì¼ê°„</button>
                        <button class="period-btn" data-period="weekly" onclick="selectPeriod('weekly')">ì£¼ê°„</button>
                        <button class="period-btn" data-period="monthly" onclick="selectPeriod('monthly')">ì›”ê°„</button>
                    </div>
                    <div class="report-card"><div class="report-card-title">ğŸ“ ê¸°ë¡ í˜„í™©</div><div class="report-stat" id="reportTotal">0ê°œ</div><div class="report-stat-sub" id="reportPeriodLabel">ì˜¤ëŠ˜ ì‘ì„±í•œ ê¸°ë¡</div></div>
                    <div class="report-card"><div class="report-card-title">ğŸ˜Š ê°ì • í‰ê· </div><div class="report-stat" id="reportEmotion">-</div><div class="report-stat-sub" id="reportEmotionDesc">ê¸°ë¡ëœ ê°ì •ì´ ì—†ì–´ìš”</div></div>
                    <div class="report-card"><div class="report-card-title">ğŸ·ï¸ ìì£¼ ì“´ íƒœê·¸</div><div class="report-keywords" id="reportTags"><span class="keyword-tag">ì•„ì§ ë°ì´í„°ê°€ ì—†ì–´ìš”</span></div></div>
                    <div class="report-card"><div class="report-card-title">ğŸ“š ì†Œë¹„í•œ ì½˜í…ì¸ </div><div class="report-stat" id="reportContents">0ê°œ</div><div class="report-stat-sub" id="reportContentsDetail">ì±… 0 Â· ì˜í™” 0 Â· TV 0</div></div>
                    <div class="export-section"><div class="export-title">ğŸ¤– AI ë¶„ì„ ë¦¬í¬íŠ¸</div><div class="export-desc">ë‚´ ê¸°ë¡ì„ Claudeì—ê²Œ ë¶„ì„ ìš”ì²­í•˜ì„¸ìš”<br>ì„œë²„ ì „ì†¡ ì—†ì´ ë³µì‚¬í•´ì„œ ì§ì ‘ ì‚¬ìš©</div><button class="export-btn" onclick="openExportModal()">í”„ë¡¬í”„íŠ¸ ìƒì„±</button></div>
                </div>
            </div>
        </main>

        <main class="main-content page" id="page-settings">
            <div class="settings-item"><div><div class="settings-label">ğŸ“± ë°ì´í„° ì €ì¥ ìœ„ì¹˜</div><div class="settings-desc">ì´ ê¸°ê¸°ì˜ ë¸Œë¼ìš°ì €ì—ë§Œ ì €ì¥ë©ë‹ˆë‹¤</div></div></div>
            <div class="settings-item"><div><div class="settings-label">ğŸ“¤ ë°ì´í„° ë‚´ë³´ë‚´ê¸°</div><div class="settings-desc">JSON íŒŒì¼ë¡œ ë°±ì—…</div></div><button class="settings-btn primary" onclick="exportData()">ë‚´ë³´ë‚´ê¸°</button></div>
            <div class="settings-item"><div><div class="settings-label">ğŸ“¥ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°</div><div class="settings-desc">JSON íŒŒì¼ì—ì„œ ë³µì›</div></div><input type="file" id="importFile" accept=".json" style="display:none" onchange="importData(event)"><button class="settings-btn primary" onclick="document.getElementById('importFile').click()">ê°€ì ¸ì˜¤ê¸°</button></div>
            <div class="settings-item"><div><div class="settings-label">ğŸ—‘ï¸ ëª¨ë“  ë°ì´í„° ì‚­ì œ</div><div class="settings-desc">ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤</div></div><button class="settings-btn danger" onclick="clearAllData()">ì‚­ì œ</button></div>
            <div class="settings-item"><div><div class="settings-label">â„¹ï¸ ë²„ì „</div><div class="settings-desc">minimi v1.0.0</div></div></div>
        </main>

        <nav class="bottom-nav">
            <button class="nav-item active" onclick="showPage('memo')"><span class="nav-icon">ğŸ“</span><span>ë©”ëª¨</span></button>
            <button class="nav-item" onclick="showPage('archive')"><span class="nav-icon">ğŸ“š</span><span>ì•„ì¹´ì´ë¸Œ</span></button>
            <button class="nav-item" onclick="showPage('lab')"><span class="nav-icon">ğŸ”¬</span><span>ì‹¤í—˜ì‹¤</span></button>
        </nav>
    </div>

    <div class="menu-overlay" id="menuOverlay" onclick="toggleMenu()">
        <div class="menu-sidebar" onclick="event.stopPropagation()">
            <div class="menu-header"><span class="menu-logo">minimi</span><button class="menu-close" onclick="toggleMenu()">Ã—</button></div>
            <div class="menu-item" onclick="showPage('memo'); toggleMenu();">ğŸ“ ë©”ëª¨</div>
            <div class="menu-item" onclick="showPage('archive'); toggleMenu();">ğŸ“š ì•„ì¹´ì´ë¸Œ</div>
            <div class="menu-item" onclick="showPage('lab'); toggleMenu();">ğŸ”¬ ì‹¤í—˜ì‹¤</div>
            <div class="menu-item" onclick="showPage('settings'); toggleMenu();">âš™ï¸ ì„¤ì •</div>
        </div>
    </div>

    <div class="modal-overlay" id="addMemoModal">
        <div class="modal">
            <div class="modal-header"><h3 class="modal-title">ìƒˆ ë©”ëª¨</h3><button class="modal-close" onclick="closeModal('addMemoModal')">Ã—</button></div>
            <div class="modal-body">
                <form onsubmit="saveMemo(event)">
                    <div class="form-group"><label class="form-label">ì œëª©</label><input type="text" class="form-input" id="memoTitle" placeholder="ì œëª© (ì„ íƒ)"></div>
                    <div class="form-group"><label class="form-label">ë‚´ìš©</label><textarea class="form-textarea" id="memoContent" placeholder="ì˜¤ëŠ˜ ìˆì—ˆë˜ ì¼, ë– ì˜¤ë¥¸ ìƒê°..." required></textarea></div>
                    <div class="form-group"><label class="form-label">íƒœê·¸</label><div class="tag-selector"><span class="tag-option active" data-tag="ì¼ìƒ" onclick="selectMemoTag(this)">ì¼ìƒ</span><span class="tag-option" data-tag="ìƒê°" onclick="selectMemoTag(this)">ìƒê°</span><span class="tag-option" data-tag="ê°ì‚¬" onclick="selectMemoTag(this)">ê°ì‚¬</span><span class="tag-option" data-tag="ëª©í‘œ" onclick="selectMemoTag(this)">ëª©í‘œ</span><span class="tag-option" data-tag="ì•„ì´ë””ì–´" onclick="selectMemoTag(this)">ì•„ì´ë””ì–´</span></div></div>
                    <div class="form-group"><label class="form-label">ì´ë¯¸ì§€</label><div class="image-upload-area" id="imageUploadArea" onclick="document.getElementById('memoImage').click()"><div class="upload-icon">ğŸ“·</div><div class="upload-text">í´ë¦­í•´ì„œ ì´ë¯¸ì§€ ì¶”ê°€</div></div><input type="file" id="memoImage" accept="image/*" style="display:none" onchange="handleImageUpload(event)"></div>
                    <button type="submit" class="form-submit">ì €ì¥í•˜ê¸°</button>
                </form>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="addArchiveModal">
        <div class="modal">
            <div class="modal-header"><h3 class="modal-title">ì½˜í…ì¸  ì¶”ê°€</h3><button class="modal-close" onclick="closeModal('addArchiveModal')">Ã—</button></div>
            <div class="modal-body">
                <form onsubmit="saveArchive(event)">
                    <div class="archive-type-grid">
                        <div class="archive-type-btn active" data-type="book" onclick="selectArchiveTypeModal(this)"><div class="archive-type-icon">ğŸ“š</div><div class="archive-type-label">ì±…</div></div>
                        <div class="archive-type-btn" data-type="movie" onclick="selectArchiveTypeModal(this)"><div class="archive-type-icon">ğŸ¬</div><div class="archive-type-label">ì˜í™”</div></div>
                        <div class="archive-type-btn" data-type="tv" onclick="selectArchiveTypeModal(this)"><div class="archive-type-icon">ğŸ“º</div><div class="archive-type-label">TV</div></div>
                        <div class="archive-type-btn" data-type="music" onclick="selectArchiveTypeModal(this)"><div class="archive-type-icon">ğŸµ</div><div class="archive-type-label">ìŒì•…</div></div>
                        <div class="archive-type-btn" data-type="game" onclick="selectArchiveTypeModal(this)"><div class="archive-type-icon">ğŸ®</div><div class="archive-type-label">ê²Œì„</div></div>
                        <div class="archive-type-btn" data-type="place" onclick="selectArchiveTypeModal(this)"><div class="archive-type-icon">ğŸ“</div><div class="archive-type-label">ì¥ì†Œ</div></div>
                    </div>
                    <div class="form-group"><label class="form-label">ì œëª©</label><input type="text" class="form-input" id="archiveTitle" placeholder="ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”" required></div>
                    <div class="form-group"><label class="form-label">ë©”ëª¨ (ì„ íƒ)</label><textarea class="form-textarea" id="archiveNote" placeholder="ê°ìƒ, ë©”ëª¨..." style="min-height: 80px;"></textarea></div>
                    <button type="submit" class="form-submit">ì¶”ê°€í•˜ê¸°</button>
                </form>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="viewDetailModal">
        <div class="modal">
            <div class="modal-header"><h3 class="modal-title">ë©”ëª¨</h3><button class="modal-close" onclick="closeModal('viewDetailModal')">Ã—</button></div>
            <div class="modal-body" id="detailContent"></div>
        </div>
    </div>

    <div class="modal-overlay" id="exportModal">
        <div class="modal">
            <div class="modal-header"><h3 class="modal-title">Claude AI ë¶„ì„ í”„ë¡¬í”„íŠ¸</h3><button class="modal-close" onclick="closeModal('exportModal')">Ã—</button></div>
            <div class="modal-body">
                <p style="font-size: 0.85rem; color: var(--text-muted); margin-bottom: 1rem;">ì•„ë˜ ë‚´ìš©ì„ ë³µì‚¬í•´ì„œ Claude.aiì— ë¶™ì—¬ë„£ìœ¼ì„¸ìš”</p>
                <textarea class="export-textarea" id="exportContent" readonly></textarea>
                <button class="copy-btn" onclick="copyExport()">ğŸ“‹ í´ë¦½ë³´ë“œì— ë³µì‚¬</button>
                <p class="copy-success" id="copySuccess">âœ“ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!</p>
            </div>
        </div>
    </div>

    <script>
        const KEYS = { memos: 'minimi_memos', emotions: 'minimi_emotions', archives: 'minimi_archives', focus: 'minimi_focus' };
        const getData = key => JSON.parse(localStorage.getItem(key) || '[]');
        const setData = (key, data) => localStorage.setItem(key, JSON.stringify(data));
        const getToday = () => new Date().toISOString().split('T')[0];
        const formatDate = iso => { const d = new Date(iso); return `${d.getMonth()+1}/${d.getDate()} ${d.getHours().toString().padStart(2,'0')}:${d.getMinutes().toString().padStart(2,'0')}`; };

        let currentPage = 'memo', currentArchiveType = 'book', selectedMemoTag = 'ì¼ìƒ', selectedArchiveTypeModal = 'book', uploadedImage = null, calendarDate = new Date(), selectedPeriod = 'daily';
        let timerInterval = null, timerSeconds = 25 * 60, isTimerRunning = false, isBreakTime = false;

        function init() { renderMemos(); renderCalendar(); renderArchives(); renderEmotionGraph(); loadTodayEmotion(); updateReport(); updateFocusStats(); }

        function showPage(page) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            document.getElementById(`page-${page}`).classList.add('active');
            const navMap = { memo: 0, archive: 1, lab: 2 };
            if (navMap[page] !== undefined) document.querySelectorAll('.nav-item')[navMap[page]].classList.add('active');
            currentPage = page;
            if (page === 'archive') { renderCalendar(); renderArchives(); }
            if (page === 'lab') updateReport();
        }

        function toggleMenu() { document.getElementById('menuOverlay').classList.toggle('active'); }
        function openAddModal() { openModal(currentPage === 'archive' ? 'addArchiveModal' : 'addMemoModal'); }
        function openModal(id) { document.getElementById(id).classList.add('active'); }
        function closeModal(id) { document.getElementById(id).classList.remove('active'); if (id === 'addMemoModal') { document.getElementById('memoTitle').value = ''; document.getElementById('memoContent').value = ''; document.getElementById('imageUploadArea').innerHTML = '<div class="upload-icon">ğŸ“·</div><div class="upload-text">í´ë¦­í•´ì„œ ì´ë¯¸ì§€ ì¶”ê°€</div>'; document.getElementById('imageUploadArea').classList.remove('has-image'); uploadedImage = null; } }

        function selectMemoTag(el) { document.querySelectorAll('.tag-option').forEach(t => t.classList.remove('active')); el.classList.add('active'); selectedMemoTag = el.dataset.tag; }
        function handleImageUpload(e) { const file = e.target.files[0]; if (!file) return; const reader = new FileReader(); reader.onload = function(ev) { uploadedImage = ev.target.result; const area = document.getElementById('imageUploadArea'); area.innerHTML = `<img src="${uploadedImage}">`; area.classList.add('has-image'); }; reader.readAsDataURL(file); }

        function saveMemo(e) {
            e.preventDefault();
            const title = document.getElementById('memoTitle').value.trim();
            const content = document.getElementById('memoContent').value.trim();
            if (!content) return;
            const memos = getData(KEYS.memos);
            memos.unshift({ id: Date.now(), title: title || null, content, tag: selectedMemoTag, image: uploadedImage, date: getToday(), timestamp: new Date().toISOString() });
            setData(KEYS.memos, memos);
            closeModal('addMemoModal');
            renderMemos();
        }

        function renderMemos() {
            const memos = getData(KEYS.memos);
            const search = document.getElementById('searchInput').value.toLowerCase();
            const filtered = memos.filter(m => m.content.toLowerCase().includes(search) || (m.title && m.title.toLowerCase().includes(search)));
            const container = document.getElementById('memoContainer');
            if (filtered.length === 0) { container.innerHTML = '<div class="empty-state"><div class="empty-icon">ğŸ“</div><div class="empty-text">ì•„ì§ ë©”ëª¨ê°€ ì—†ì–´ìš”</div></div>'; return; }
            container.innerHTML = filtered.map(m => `<div class="card-mini" onclick="viewMemo(${m.id})">${m.image ? `<div class="card-image-placeholder"><img src="${m.image}"></div>` : ''}<div class="card-content-wrapper">${m.title ? `<div class="card-title">${m.title}</div>` : ''}<div class="card-date">${formatDate(m.timestamp)}</div><div class="card-content-text">${m.content}</div><span class="card-tag">${m.tag}</span></div></div>`).join('');
        }

        function viewMemo(id) {
            const memo = getData(KEYS.memos).find(m => m.id === id);
            if (!memo) return;
            document.getElementById('detailContent').innerHTML = `${memo.image ? `<img src="${memo.image}" class="detail-image">` : ''}${memo.title ? `<div class="detail-title">${memo.title}</div>` : ''}<div class="detail-meta"><span>${formatDate(memo.timestamp)}</span><span>${memo.tag}</span></div><div class="detail-content">${memo.content}</div><div class="detail-actions"><button class="detail-btn delete" onclick="deleteMemo(${memo.id})">ì‚­ì œ</button></div>`;
            openModal('viewDetailModal');
        }

        function deleteMemo(id) { if (!confirm('ì‚­ì œí• ê¹Œìš”?')) return; setData(KEYS.memos, getData(KEYS.memos).filter(m => m.id !== id)); closeModal('viewDetailModal'); renderMemos(); }
        function handleSearch() { renderMemos(); }

        function selectArchiveType(type) { document.querySelectorAll('.archive-tab').forEach(t => t.classList.remove('active')); document.querySelector(`.archive-tab[data-type="${type}"]`).classList.add('active'); currentArchiveType = type; renderArchives(); }
        function selectArchiveTypeModal(el) { document.querySelectorAll('.archive-type-btn').forEach(b => b.classList.remove('active')); el.classList.add('active'); selectedArchiveTypeModal = el.dataset.type; }

        function saveArchive(e) {
            e.preventDefault();
            const title = document.getElementById('archiveTitle').value.trim();
            const note = document.getElementById('archiveNote').value.trim();
            if (!title) return;
            const archives = getData(KEYS.archives);
            archives.unshift({ id: Date.now(), title, note: note || null, type: selectedArchiveTypeModal, date: getToday(), timestamp: new Date().toISOString() });
            setData(KEYS.archives, archives);
            closeModal('addArchiveModal');
            document.getElementById('archiveTitle').value = '';
            document.getElementById('archiveNote').value = '';
            renderArchives(); renderCalendar();
        }

        function renderArchives() {
            const archives = getData(KEYS.archives).filter(a => a.type === currentArchiveType);
            const icons = { book: 'ğŸ“š', movie: 'ğŸ¬', tv: 'ğŸ“º', music: 'ğŸµ', game: 'ğŸ®', place: 'ğŸ“' };
            const container = document.getElementById('archiveList');
            if (archives.length === 0) { container.innerHTML = `<div class="empty-state"><div class="empty-icon">${icons[currentArchiveType]}</div><div class="empty-text">ì•„ì§ ê¸°ë¡ì´ ì—†ì–´ìš”</div></div>`; return; }
            container.innerHTML = archives.map(a => `<div class="archive-item"><div class="archive-item-thumb">${icons[a.type]}</div><div class="archive-item-info"><div class="archive-item-title">${a.title}</div><div class="archive-item-date">${formatDate(a.timestamp)}</div></div><button class="archive-item-delete" onclick="deleteArchive(${a.id})">Ã—</button></div>`).join('');
        }

        function deleteArchive(id) { if (!confirm('ì‚­ì œí• ê¹Œìš”?')) return; setData(KEYS.archives, getData(KEYS.archives).filter(a => a.id !== id)); renderArchives(); renderCalendar(); }

        function renderCalendar() {
            const y = calendarDate.getFullYear(), m = calendarDate.getMonth();
            document.getElementById('calendarTitle').textContent = `${y}ë…„ ${m + 1}ì›”`;
            const firstDay = new Date(y, m, 1).getDay(), lastDate = new Date(y, m + 1, 0).getDate();
            const archiveDates = getData(KEYS.archives).filter(a => a.type === currentArchiveType).map(a => a.date);
            const today = getToday();
            let html = ['ì¼','ì›”','í™”','ìˆ˜','ëª©','ê¸ˆ','í† '].map(d => `<div class="cal-weekday">${d}</div>`).join('');
            for (let i = 0; i < firstDay; i++) html += '<div class="cal-day"></div>';
            for (let d = 1; d <= lastDate; d++) {
                const dateStr = `${y}-${String(m+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`;
                html += `<div class="cal-day ${dateStr === today ? 'today' : ''} ${archiveDates.includes(dateStr) ? 'has-content' : ''}">${d}</div>`;
            }
            document.getElementById('calendarGrid').innerHTML = html;
        }
        function prevMonth() { calendarDate.setMonth(calendarDate.getMonth() - 1); renderCalendar(); }
        function nextMonth() { calendarDate.setMonth(calendarDate.getMonth() + 1); renderCalendar(); }

        function selectLabTab(tab) {
            document.querySelectorAll('.lab-tab').forEach(t => t.classList.remove('active'));
            document.querySelector(`.lab-tab[data-tab="${tab}"]`).classList.add('active');
            document.querySelectorAll('.lab-tab-content').forEach(c => c.classList.remove('active'));
            document.getElementById(`tab-${tab}`).classList.add('active');
        }

        function setEmotion(level) {
            document.querySelectorAll('.emotion-btn').forEach(b => b.classList.remove('selected'));
            document.querySelector(`.emotion-btn[data-level="${level}"]`).classList.add('selected');
            const emotions = getData(KEYS.emotions), today = getToday();
            const idx = emotions.findIndex(e => e.date === today);
            const entry = { date: today, level, timestamp: new Date().toISOString() };
            if (idx >= 0) emotions[idx] = entry; else emotions.push(entry);
            setData(KEYS.emotions, emotions);
            renderEmotionGraph();
        }

        function loadTodayEmotion() { const e = getData(KEYS.emotions).find(e => e.date === getToday()); if (e) document.querySelector(`.emotion-btn[data-level="${e.level}"]`)?.classList.add('selected'); }

        function renderEmotionGraph() {
            const emotions = getData(KEYS.emotions), days = [];
            for (let i = 13; i >= 0; i--) { const d = new Date(); d.setDate(d.getDate() - i); days.push(d.toISOString().split('T')[0]); }
            const map = {}; emotions.forEach(e => map[e.date] = e.level);
            document.getElementById('emotionGraph').innerHTML = days.map(day => {
                const level = map[day], height = level ? (6 - level) * 15 + 10 : 5;
                const d = new Date(day);
                return `<div class="emotion-bar-item"><div class="emotion-bar" style="height:${height}px;${!level ? 'background:#E5E7EB;' : ''}"></div><span class="emotion-bar-label">${d.getMonth()+1}/${d.getDate()}</span></div>`;
            }).join('');
        }

        function toggleTimer() {
            if (isTimerRunning) { clearInterval(timerInterval); document.getElementById('timerStartBtn').textContent = 'ê³„ì†'; }
            else { timerInterval = setInterval(updateTimer, 1000); document.getElementById('timerStartBtn').textContent = 'ì¼ì‹œì •ì§€'; }
            isTimerRunning = !isTimerRunning;
        }

        function updateTimer() {
            if (timerSeconds <= 0) {
                clearInterval(timerInterval); isTimerRunning = false;
                if (!isBreakTime) {
                    const focus = getData(KEYS.focus); focus.push({ date: getToday(), duration: 25, timestamp: new Date().toISOString() }); setData(KEYS.focus, focus); updateFocusStats();
                    isBreakTime = true; timerSeconds = 5 * 60; document.getElementById('timerLabel').textContent = 'íœ´ì‹ ì‹œê°„'; alert('ì§‘ì¤‘ ì‹œê°„ ì™„ë£Œ! 5ë¶„ íœ´ì‹í•˜ì„¸ìš”.');
                } else { isBreakTime = false; timerSeconds = 25 * 60; document.getElementById('timerLabel').textContent = 'ì§‘ì¤‘ ì‹œê°„'; alert('íœ´ì‹ ë! ë‹¤ì‹œ ì§‘ì¤‘í•´ë³¼ê¹Œìš”?'); }
                document.getElementById('timerStartBtn').textContent = 'ì‹œì‘'; updateTimerDisplay(); return;
            }
            timerSeconds--; updateTimerDisplay();
        }

        function updateTimerDisplay() { document.getElementById('timerDisplay').textContent = `${Math.floor(timerSeconds/60).toString().padStart(2,'0')}:${(timerSeconds%60).toString().padStart(2,'0')}`; }
        function resetTimer() { clearInterval(timerInterval); isTimerRunning = false; isBreakTime = false; timerSeconds = 25 * 60; document.getElementById('timerStartBtn').textContent = 'ì‹œì‘'; document.getElementById('timerLabel').textContent = 'ì§‘ì¤‘ ì‹œê°„'; updateTimerDisplay(); }
        function updateFocusStats() { const focus = getData(KEYS.focus).filter(f => f.date === getToday()); document.getElementById('todayFocusTime').textContent = `${focus.reduce((s,f) => s + f.duration, 0)}ë¶„`; document.getElementById('todayFocusCount').textContent = `${focus.length}íšŒ ì™„ë£Œ`; }

        function selectPeriod(period) { document.querySelectorAll('.period-btn').forEach(b => b.classList.remove('active')); document.querySelector(`.period-btn[data-period="${period}"]`).classList.add('active'); selectedPeriod = period; updateReport(); }

        function updateReport() {
            const memos = getData(KEYS.memos), emotions = getData(KEYS.emotions), archives = getData(KEYS.archives);
            let startDate = new Date(), periodLabel = '';
            const todayStr = getToday();
            if (selectedPeriod === 'daily') periodLabel = 'ì˜¤ëŠ˜ ì‘ì„±í•œ ê¸°ë¡';
            else if (selectedPeriod === 'weekly') { startDate.setDate(startDate.getDate() - 7); periodLabel = 'ì´ë²ˆ ì£¼ ì‘ì„±í•œ ê¸°ë¡'; }
            else { startDate.setMonth(startDate.getMonth() - 1); periodLabel = 'ì´ë²ˆ ë‹¬ ì‘ì„±í•œ ê¸°ë¡'; }
            const startStr = startDate.toISOString().split('T')[0];
            const fMemos = selectedPeriod === 'daily' ? memos.filter(m => m.date === todayStr) : memos.filter(m => m.date >= startStr);
            const fEmotions = selectedPeriod === 'daily' ? emotions.filter(e => e.date === todayStr) : emotions.filter(e => e.date >= startStr);
            const fArchives = selectedPeriod === 'daily' ? archives.filter(a => a.date === todayStr) : archives.filter(a => a.date >= startStr);
            document.getElementById('reportTotal').textContent = `${fMemos.length + fArchives.length}ê°œ`;
            document.getElementById('reportPeriodLabel').textContent = periodLabel;
            if (fEmotions.length > 0) { const avg = fEmotions.reduce((s,e) => s + e.level, 0) / fEmotions.length; const labels = ['','ğŸ˜Š ì•„ì£¼ ì¢‹ìŒ','ğŸ™‚ ì¢‹ìŒ','ğŸ˜ ë³´í†µ','ğŸ˜” ë³„ë¡œ','ğŸ˜¢ ì•ˆì¢‹ìŒ']; document.getElementById('reportEmotion').textContent = labels[Math.round(avg)]; document.getElementById('reportEmotionDesc').textContent = `í‰ê·  ${avg.toFixed(1)}ì  (${fEmotions.length}íšŒ)`; }
            else { document.getElementById('reportEmotion').textContent = '-'; document.getElementById('reportEmotionDesc').textContent = 'ê¸°ë¡ëœ ê°ì •ì´ ì—†ì–´ìš”'; }
            const tagCounts = {}; fMemos.forEach(m => tagCounts[m.tag] = (tagCounts[m.tag] || 0) + 1);
            const sortedTags = Object.entries(tagCounts).sort((a,b) => b[1] - a[1]);
            document.getElementById('reportTags').innerHTML = sortedTags.length > 0 ? sortedTags.map((t,i) => `<span class="keyword-tag ${i===0?'highlight':''}">${t[0]} (${t[1]})</span>`).join('') : '<span class="keyword-tag">ì•„ì§ ë°ì´í„°ê°€ ì—†ì–´ìš”</span>';
            const books = fArchives.filter(a => a.type === 'book').length, movies = fArchives.filter(a => a.type === 'movie').length, tvs = fArchives.filter(a => a.type === 'tv').length;
            document.getElementById('reportContents').textContent = `${fArchives.length}ê°œ`;
            document.getElementById('reportContentsDetail').textContent = `ì±… ${books} Â· ì˜í™” ${movies} Â· TV ${tvs}`;
        }

        function openExportModal() { document.getElementById('exportContent').value = generateClaudePrompt(); openModal('exportModal'); }
        function generateClaudePrompt() {
            const memos = getData(KEYS.memos), emotions = getData(KEYS.emotions), archives = getData(KEYS.archives);
            let startDate = new Date(), periodName = '';
            const todayStr = getToday();
            if (selectedPeriod === 'daily') periodName = 'ì˜¤ëŠ˜';
            else if (selectedPeriod === 'weekly') { startDate.setDate(startDate.getDate() - 7); periodName = 'ì´ë²ˆ ì£¼'; }
            else { startDate.setMonth(startDate.getMonth() - 1); periodName = 'ì´ë²ˆ ë‹¬'; }
            const startStr = startDate.toISOString().split('T')[0];
            const fMemos = selectedPeriod === 'daily' ? memos.filter(m => m.date === todayStr) : memos.filter(m => m.date >= startStr);
            const fEmotions = selectedPeriod === 'daily' ? emotions.filter(e => e.date === todayStr) : emotions.filter(e => e.date >= startStr);
            const fArchives = selectedPeriod === 'daily' ? archives.filter(a => a.date === todayStr) : archives.filter(a => a.date >= startStr);
            let prompt = `ë‹¹ì‹ ì€ ê°œì¸ ê¸°ë¡ ë¶„ì„ ì „ë¬¸ê°€ì…ë‹ˆë‹¤. ì•„ë˜ëŠ” ì œê°€ ${periodName} ê¸°ë¡í•œ ë°ì´í„°ì…ë‹ˆë‹¤. ë¶„ì„í•´ì„œ ì¸ì‚¬ì´íŠ¸ë¥¼ ì œê³µí•´ì£¼ì„¸ìš”.\n\n## ë¶„ì„ ìš”ì²­\n1. ì „ë°˜ì ì¸ ê°ì • ìƒíƒœì™€ íë¦„\n2. ì£¼ìš” ê´€ì‹¬ì‚¬ë‚˜ ìƒê° íŒ¨í„´\n3. ì†Œë¹„í•œ ì½˜í…ì¸ ì—ì„œ ë³´ì´ëŠ” ì·¨í–¥\n4. ê°œì„ í•˜ê±°ë‚˜ ì£¼ì˜í•  ì \n5. ê²©ë ¤ ë©”ì‹œì§€\n\n---\n\n## ğŸ“Š ê¸°ë¡ ë°ì´í„°\n\n### ê°ì • ê¸°ë¡ (1=ì•„ì£¼ì¢‹ìŒ ~ 5=ì•ˆì¢‹ìŒ)\n`;
            if (fEmotions.length > 0) { const labels = ['','ğŸ˜Šì•„ì£¼ì¢‹ìŒ','ğŸ™‚ì¢‹ìŒ','ğŸ˜ë³´í†µ','ğŸ˜”ë³„ë¡œ','ğŸ˜¢ì•ˆì¢‹ìŒ']; fEmotions.forEach(e => prompt += `- ${e.date}: ${labels[e.level]}\n`); } else prompt += `ê¸°ë¡ ì—†ìŒ\n`;
            prompt += `\n### ë©”ëª¨/ì¼ê¸°\n`;
            if (fMemos.length > 0) fMemos.forEach(m => prompt += `- [${m.date}] [${m.tag}] ${m.title ? m.title + ': ' : ''}${m.content}\n`); else prompt += `ê¸°ë¡ ì—†ìŒ\n`;
            prompt += `\n### ì†Œë¹„í•œ ì½˜í…ì¸ \n`;
            if (fArchives.length > 0) { const types = {book:'ì±…',movie:'ì˜í™”',tv:'TV',music:'ìŒì•…',game:'ê²Œì„',place:'ì¥ì†Œ'}; fArchives.forEach(a => prompt += `- [${types[a.type]}] ${a.title} (${a.date})\n`); } else prompt += `ê¸°ë¡ ì—†ìŒ\n`;
            prompt += `\n---\n\nìœ„ ë°ì´í„°ë¥¼ ë°”íƒ•ìœ¼ë¡œ ${periodName}ì˜ ì €ì— ëŒ€í•´ ì¹œê·¼í•˜ê³  ë”°ëœ»í•œ í†¤ìœ¼ë¡œ ë¶„ì„í•´ì£¼ì„¸ìš”.`;
            return prompt;
        }
        function copyExport() { document.getElementById('exportContent').select(); document.execCommand('copy'); document.getElementById('copySuccess').style.display = 'block'; setTimeout(() => document.getElementById('copySuccess').style.display = 'none', 2000); }

        function exportData() { const data = { memos: getData(KEYS.memos), emotions: getData(KEYS.emotions), archives: getData(KEYS.archives), focus: getData(KEYS.focus), exportDate: new Date().toISOString() }; const blob = new Blob([JSON.stringify(data, null, 2)], {type: 'application/json'}); const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download = `minimi_backup_${getToday()}.json`; a.click(); }
        function importData(e) { const file = e.target.files[0]; if (!file) return; const reader = new FileReader(); reader.onload = function(ev) { try { const data = JSON.parse(ev.target.result); if (data.memos) setData(KEYS.memos, data.memos); if (data.emotions) setData(KEYS.emotions, data.emotions); if (data.archives) setData(KEYS.archives, data.archives); if (data.focus) setData(KEYS.focus, data.focus); alert('ë°ì´í„°ë¥¼ ì„±ê³µì ìœ¼ë¡œ ê°€ì ¸ì™”ìŠµë‹ˆë‹¤!'); init(); } catch(err) { alert('íŒŒì¼ ì½ê¸° ì˜¤ë¥˜'); } }; reader.readAsText(file); }
        function clearAllData() { if (!confirm('ì •ë§ ëª¨ë“  ë°ì´í„°ë¥¼ ì‚­ì œí• ê¹Œìš”?')) return; if (!confirm('ë§ˆì§€ë§‰ í™•ì¸ì…ë‹ˆë‹¤. ì‚­ì œí• ê¹Œìš”?')) return; Object.values(KEYS).forEach(k => localStorage.removeItem(k)); alert('ëª¨ë“  ë°ì´í„°ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.'); init(); }

        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
