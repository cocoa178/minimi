<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>minimi</title>
    <meta name="theme-color" content="#B1D9D4">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <link rel="manifest" href="manifest.json">
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="icon.svg">
    <link rel="apple-touch-icon" href="icon.svg">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="app-container">
        <header class="app-header-bar">
            <div class="header-left"><div class="menu-icon" onclick="toggleMenu()"><span></span><span></span><span></span></div><input type="text" class="app-search-input" placeholder="검색" id="searchInput" oninput="handleSearch()"></div>
            <div class="header-right">
                <div class="view-icons">
                    <button class="view-icon-btn active" data-mode="masonry" onclick="setViewMode('masonry')" title="메이슨리">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><rect x="3" y="3" width="8" height="10" rx="1"/><rect x="13" y="3" width="8" height="6" rx="1"/><rect x="3" y="15" width="8" height="6" rx="1"/><rect x="13" y="11" width="8" height="10" rx="1"/></svg>
                    </button>
                    <button class="view-icon-btn" data-mode="grid" onclick="setViewMode('grid')" title="그리드">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><rect x="3" y="3" width="8" height="8" rx="1"/><rect x="13" y="3" width="8" height="8" rx="1"/><rect x="3" y="13" width="8" height="8" rx="1"/><rect x="13" y="13" width="8" height="8" rx="1"/></svg>
                    </button>
                    <button class="view-icon-btn" data-mode="list" onclick="setViewMode('list')" title="리스트">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><rect x="3" y="4" width="18" height="4" rx="1"/><rect x="3" y="10" width="18" height="4" rx="1"/><rect x="3" y="16" width="18" height="4" rx="1"/></svg>
                    </button>
                </div>
                <div class="add-btn" onclick="openAddModal()">+</div>
                <div class="profile-pic" onclick="showPage('settings')">😊</div>
            </div>
        </header>
        <main class="main-content page active" id="page-memo">
            <div id="memoViewContainer"><div class="cards-compact" id="memoContainer"></div></div>
        </main>
        <main class="main-content page" id="page-archive">
            <div class="archive-tabs"><button class="archive-tab active" data-type="book" onclick="selectArchiveType('book')">📚 책</button><button class="archive-tab" data-type="movie" onclick="selectArchiveType('movie')">🎬 영화</button><button class="archive-tab" data-type="tv" onclick="selectArchiveType('tv')">📺 드라마</button><button class="archive-tab" data-type="game" onclick="selectArchiveType('game')">🎮 게임</button><button class="archive-tab" data-type="place" onclick="selectArchiveType('place')">🍽️ 식당</button></div>
            <div class="archive-content"><div class="archive-list" id="archiveList"></div></div>
        </main>
        <main class="main-content page" id="page-lab">
            <div class="lab-tabs">
                <div class="lab-tab active" data-tab="emotion" onclick="selectLabTab('emotion')">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M12 21l-1.5-1.3C5.4 15.4 2 12.3 2 8.5 2 5.4 4.4 3 7.5 3c1.7 0 3.4.8 4.5 2.1C13.1 3.8 14.8 3 16.5 3 19.6 3 22 5.4 22 8.5c0 3.8-3.4 6.9-8.5 11.2L12 21z"/><path d="M2 12h4l2-4 3 8 2-4h9" stroke="white" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/></svg>
                </div>
                <div class="lab-tab" data-tab="timer" onclick="selectLabTab('timer')">집중 타이머</div>
                <div class="lab-tab" data-tab="report" onclick="selectLabTab('report')">리포터M</div>
            </div>
            <div class="lab-content">
                <div class="lab-tab-content active" id="tab-emotion">
                    <!-- 감정 입력 섹션 (접기 가능) -->
                    <div class="collapsible-section">
                        <div class="collapsible-header" onclick="toggleSection('emotionInput')">
                            <span class="collapsible-title">감정 기록하기</span>
                            <span class="collapsible-arrow" id="emotionInputArrow">▼</span>
                        </div>
                        <div class="collapsible-content open" id="emotionInputContent">
                            <div class="emotion-slider-container">
                                <div class="emotion-slider-labels">
                                    <span>😢</span><span>😔</span><span>😐</span><span>🙂</span><span>😊</span>
                                </div>
                                <input type="range" min="1" max="5" value="3" class="emotion-slider" id="emotionSlider" oninput="updateEmotionPreview()">
                                <div class="emotion-preview" id="emotionPreview">😐</div>
                            </div>
                            <div class="emotion-reason-input">
                                <input type="text" id="emotionReason" placeholder="사유 (선택)" class="form-input">
                            </div>
                            <div class="emotion-time-row">
                                <select id="emotionHour" class="time-select"></select>
                                <span>:</span>
                                <select id="emotionMinute" class="time-select"></select>
                                <button onclick="setEmotionTimeToNow()" class="time-now-btn">지금</button>
                                <button onclick="saveEmotion()" class="emotion-save-btn">저장</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 감정 표 (0-23시) 섹션 (접기 가능) -->
                    <div class="collapsible-section">
                        <div class="collapsible-header" onclick="toggleSection('emotionTable')">
                            <span class="collapsible-title">시간별 감정 기록</span>
                            <span class="collapsible-arrow" id="emotionTableArrow">▼</span>
                        </div>
                        <div class="collapsible-content open" id="emotionTableContent">
                            <div class="emotion-date-selector">
                                <button onclick="changeEmotionDate(-1)">◀</button>
                                <span id="emotionDateDisplay"></span>
                                <button onclick="changeEmotionDate(1)">▶</button>
                            </div>
                            <div class="emotion-table-container">
                                <table class="emotion-table" id="emotionTable">
                                    <thead>
                                        <tr>
                                            <th>시간</th>
                                            <th>감정</th>
                                            <th>사유</th>
                                            <th></th>
                                        </tr>
                                    </thead>
                                    <tbody id="emotionTableBody"></tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 감정 그래프 섹션 (접기 가능) -->
                    <div class="collapsible-section">
                        <div class="collapsible-header" onclick="toggleSection('emotionGraph')">
                            <span class="collapsible-title">감정 그래프</span>
                            <span class="collapsible-arrow" id="emotionGraphArrow">▼</span>
                        </div>
                        <div class="collapsible-content open" id="emotionGraphContent">
                            <div class="graph-settings-row">
                                <select id="graphPeriod" onchange="renderEmotionGraph()" class="graph-select">
                                    <option value="7">1주일</option>
                                    <option value="14" selected>2주일</option>
                                    <option value="30">1개월</option>
                                </select>
                                <select id="graphStyle" onchange="renderEmotionGraph()" class="graph-select">
                                    <option value="line">꺾은선</option>
                                    <option value="bar">막대</option>
                                </select>
                            </div>
                            <div class="emotion-line-chart" id="emotionLineChart"></div>
                        </div>
                    </div>
                </div>
                <div class="lab-tab-content" id="tab-timer"><div class="timer-display"><div class="timer-time" id="timerDisplay">25:00</div><div class="timer-label" id="timerLabel">집중 시간</div><div class="timer-controls"><button class="timer-btn primary" id="timerStartBtn" onclick="toggleTimer()">시작</button><button class="timer-btn secondary" onclick="resetTimer()">리셋</button></div></div><div class="report-card"><div class="report-card-title">오늘의 집중</div><div class="report-stat" id="todayFocusTime">0분</div><div class="report-stat-sub" id="todayFocusCount">0회 완료</div></div></div>
                <div class="lab-tab-content" id="tab-report"><div class="report-period-selector"><button class="period-btn active" data-period="daily" onclick="selectPeriod('daily')">일간</button><button class="period-btn" data-period="weekly" onclick="selectPeriod('weekly')">주간</button><button class="period-btn" data-period="monthly" onclick="selectPeriod('monthly')">월간</button></div><div class="report-card"><div class="report-card-title" id="reportPeriodLabel">오늘 작성한 기록</div><div class="report-stat" id="reportTotal">0개</div></div><div class="report-card"><div class="report-card-title">평균 감정</div><div class="report-stat" id="reportEmotion">-</div><div class="report-stat-sub" id="reportEmotionDesc">기록된 감정이 없어요</div></div><div class="report-card"><div class="report-card-title">자주 쓴 태그</div><div class="report-keywords" id="reportTags"></div></div><div class="report-card"><div class="report-card-title">소비한 콘텐츠</div><div class="report-stat" id="reportContents">0개</div><div class="report-stat-sub" id="reportContentsDetail">책 0 · 영화 0 · TV 0</div></div><div class="export-section"><div class="export-title">🤖 AI 분석 받기</div><div class="export-desc">Claude에게 분석을 요청할 수 있는<br>프롬프트를 생성합니다</div><button class="export-btn" onclick="openExportModal()">프롬프트 생성하기</button></div></div>
            </div>
        </main>
        <main class="main-content page" id="page-settings"><div class="settings-content"><div class="settings-item"><div><div class="settings-label">데이터 백업</div><div class="settings-desc">JSON 파일로 내보내기</div></div><button class="settings-btn primary" onclick="exportData()">내보내기</button></div><div class="settings-item"><div><div class="settings-label">데이터 복원</div><div class="settings-desc">JSON 파일에서 가져오기</div></div><label class="settings-btn primary" style="cursor:pointer;">가져오기<input type="file" accept=".json" onchange="importData(event)" style="display:none;"></label></div><div class="settings-item"><div><div class="settings-label">전체 데이터 삭제</div><div class="settings-desc">모든 기록을 삭제합니다</div></div><button class="settings-btn danger" onclick="clearAllData()">삭제</button></div></div></main>
        <nav class="bottom-nav"><button class="nav-item active" onclick="showPage('memo')"><span class="nav-icon">📝</span>메모</button><button class="nav-item" onclick="showPage('archive')"><span class="nav-icon">📚</span>아카이브</button><button class="nav-item" onclick="showPage('lab')"><span class="nav-icon">📊</span>Lab</button></nav>
    </div>
    <div class="menu-overlay" id="menuOverlay" onclick="toggleMenu()"><div class="menu-sidebar" onclick="event.stopPropagation()"><div class="menu-header"><span class="menu-logo">minimi</span><button class="menu-close" onclick="toggleMenu()">×</button></div><div class="menu-item" onclick="showPage('memo');toggleMenu();">📝 메모</div><div class="menu-item" onclick="showPage('archive');toggleMenu();">📚 아카이브</div><div class="menu-item" onclick="showPage('lab');toggleMenu();">📊 Lab</div><div class="menu-item" onclick="showPage('settings');toggleMenu();">⚙️ 설정</div></div></div>
    <div class="modal-overlay" id="addMemoModal"><div class="modal"><div class="modal-header"><span class="modal-title" id="memoModalTitle">새 메모</span><button class="modal-close" onclick="closeModal('addMemoModal')">×</button></div><div class="modal-body"><form onsubmit="saveMemo(event)"><div class="form-group"><label class="form-label">제목 (선택)</label><input type="text" class="form-input" id="memoTitle" placeholder="제목을 입력하세요"></div><div class="form-group"><label class="form-label">내용</label><textarea class="form-textarea" id="memoContent" placeholder="오늘 무슨 일이 있었나요?"></textarea></div><div class="form-group"><label class="form-label">태그</label><div class="tag-selector"><span class="tag-option active" data-tag="일상" onclick="selectMemoTag(this)">일상</span><span class="tag-option" data-tag="생각" onclick="selectMemoTag(this)">생각</span><span class="tag-option" data-tag="일" onclick="selectMemoTag(this)">일</span><span class="tag-option" data-tag="취미" onclick="selectMemoTag(this)">취미</span><span class="tag-option" data-tag="여행" onclick="selectMemoTag(this)">여행</span></div></div><button type="button" class="search-content-btn" onclick="openSearchModal()">🔍 책/영화/드라마/게임/식당 첨부하기</button><div class="attached-content" id="attachedContent" style="display:none;"><div class="attached-content-thumb" id="attachedThumb"></div><div class="attached-content-info"><div class="attached-content-title" id="attachedTitle"></div><div class="attached-content-meta" id="attachedMeta"></div></div><button type="button" class="attached-content-remove" onclick="removeAttachment()">×</button></div><div class="form-group"><label class="form-label">이미지 (선택)</label><label class="image-upload-area" id="imageUploadArea"><div class="upload-icon">📷</div><div class="upload-text">클릭해서 이미지 추가</div><input type="file" accept="image/*" onchange="handleImageUpload(event)" style="display:none;"></label></div><input type="hidden" id="editMemoId"><button type="submit" class="form-submit" id="memoSubmitBtn">저장</button></form></div></div></div>
    <div class="modal-overlay" id="searchContentModal"><div class="modal"><div class="modal-header"><span class="modal-title">콘텐츠 검색</span><button class="modal-close" onclick="closeModal('searchContentModal')">×</button></div><div class="modal-body"><div class="search-tabs"><button class="search-tab active" data-type="book" onclick="selectSearchType('book')">📚 책</button><button class="search-tab" data-type="movie" onclick="selectSearchType('movie')">🎬 영화</button><button class="search-tab" data-type="tv" onclick="selectSearchType('tv')">📺 드라마</button><button class="search-tab" data-type="game" onclick="selectSearchType('game')">🎮 게임</button><button class="search-tab" data-type="place" onclick="selectSearchType('place')">🍽️ 식당</button></div><div class="search-input-group"><input type="text" id="contentSearchInput" placeholder="검색어를 입력하세요" onkeypress="handleSearchKeypress(event)"><button onclick="searchContent()">검색</button></div><div class="search-results" id="searchResults"><div class="search-empty">검색어를 입력하세요</div></div></div></div></div>
    <div class="modal-overlay" id="viewDetailModal"><div class="modal"><div class="modal-header"><span class="modal-title">메모 상세</span><button class="modal-close" onclick="closeModal('viewDetailModal')">×</button></div><div class="modal-body" id="detailContent"></div></div></div>
    <div class="modal-overlay" id="addArchiveModal"><div class="modal"><div class="modal-header"><span class="modal-title">아카이브 추가</span><button class="modal-close" onclick="closeModal('addArchiveModal')">×</button></div><div class="modal-body"><form onsubmit="saveArchive(event)"><div class="form-group"><label class="form-label">카테고리</label><div class="archive-type-grid"><div class="archive-type-btn active" data-type="book" onclick="selectArchiveTypeModal(this)"><div class="archive-type-icon">📚</div><div class="archive-type-label">책</div></div><div class="archive-type-btn" data-type="movie" onclick="selectArchiveTypeModal(this)"><div class="archive-type-icon">🎬</div><div class="archive-type-label">영화</div></div><div class="archive-type-btn" data-type="tv" onclick="selectArchiveTypeModal(this)"><div class="archive-type-icon">📺</div><div class="archive-type-label">드라마</div></div><div class="archive-type-btn" data-type="game" onclick="selectArchiveTypeModal(this)"><div class="archive-type-icon">🎮</div><div class="archive-type-label">게임</div></div><div class="archive-type-btn" data-type="place" onclick="selectArchiveTypeModal(this)"><div class="archive-type-icon">🍽️</div><div class="archive-type-label">식당</div></div></div></div><button type="button" class="search-content-btn" onclick="openArchiveSearchModal()">🔍 네이버에서 검색하기</button><div id="archiveSearchResult" style="display:none;"></div><div class="form-group"><label class="form-label">제목</label><input type="text" class="form-input" id="archiveTitle" placeholder="제목을 입력하세요" required></div><div class="form-group"><label class="form-label">메모 (선택)</label><textarea class="form-textarea" id="archiveNote" placeholder="감상평이나 메모를 남겨보세요" style="min-height:80px;"></textarea></div><input type="hidden" id="archiveImage"><input type="hidden" id="archiveAuthor"><input type="hidden" id="archiveDirector"><input type="hidden" id="archiveAddress"><button type="submit" class="form-submit">저장</button></form></div></div></div>
    <div class="modal-overlay" id="exportModal"><div class="modal"><div class="modal-header"><span class="modal-title">Claude 분석 프롬프트</span><button class="modal-close" onclick="closeModal('exportModal')">×</button></div><div class="modal-body"><textarea class="export-textarea" id="exportContent" readonly></textarea><button class="copy-btn" onclick="copyExport()">📋 클립보드에 복사</button><p class="copy-success" id="copySuccess">✓ 복사되었습니다!</p></div></div></div>
    <script src="app.js"></script>
</body>
</html>
